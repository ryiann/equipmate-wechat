<!--pages/repair-create/repair-create.wxml-->
<view class="page-form">
  <view class="form-card card">
    <!-- 选择设备 -->
    <view class="form-item" bindtap="selectEquipment">
      <text class="form-label required">选择设备</text>
      <view class="form-picker">
        <text class="{{form.equipmentName ? '' : 'placeholder'}}">{{form.equipmentName || '请选择要报修的设备'}}</text>
        <image src="/images/icons/chevron-right-gray.png" class="picker-arrow" mode="aspectFit"></image>
      </view>
    </view>

    <!-- 故障等级 -->
    <view class="form-item">
      <text class="form-label required">故障等级</text>
      <view class="level-selector">
        <view 
          class="level-option {{form.faultLevel === item.value ? 'active ' + item.activeClass : ''}}" 
          wx:for="{{faultLevels}}" 
          wx:key="value"
          bindtap="selectLevel"
          data-level="{{item.value}}"
        >
          <text>{{item.label}}</text>
        </view>
      </view>
    </view>

    <!-- 故障描述 -->
    <view class="form-item">
      <text class="form-label required">故障描述</text>
      <textarea 
        class="form-textarea" 
        placeholder="请详细描述故障现象、发生时间等信息" 
        value="{{form.faultDesc}}" 
        bindinput="onInput" 
        data-field="faultDesc" 
        maxlength="500"
        auto-height
      ></textarea>
      <text class="char-count">{{form.faultDesc.length || 0}}/500</text>
    </view>

    <!-- 现场图片 -->
    <view class="form-item">
      <text class="form-label">现场图片</text>
      <view class="image-upload-grid">
        <view class="upload-item" wx:for="{{imageList}}" wx:key="*this">
          <image class="upload-preview" src="{{item}}" mode="aspectFill"></image>
          <view class="upload-delete" catchtap="deleteImage" data-index="{{index}}">×</view>
        </view>
        <view class="upload-add" bindtap="chooseImage" wx:if="{{imageList.length < 9}}">
          <image src="/images/icons/camera-gray.png" class="upload-add-icon" mode="aspectFit"></image>
          <text>拍照/选图</text>
        </view>
      </view>
    </view>

    <!-- 备注 -->
    <view class="form-item">
      <text class="form-label">备注信息</text>
      <textarea class="form-textarea" placeholder="其他补充说明(选填)" value="{{form.memo}}" bindinput="onInput" data-field="memo" maxlength="200" auto-height></textarea>
    </view>
  </view>

  <view class="submit-wrap">
    <view class="submit-btn" bindtap="onSubmit">
      <text>提交报修</text>
    </view>
  </view>
</view>
